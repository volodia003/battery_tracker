════════════════════════════════════════════════════════════════════════════════
                  BATTERY TRACKER - ИНСТРУКЦИЯ ПО РАЗВЕРТЫВАНИЮ
════════════════════════════════════════════════════════════════════════════════

1. СИСТЕМНЫЕ ТРЕБОВАНИЯ
────────────────────────

   1.1. ОПЕРАЦИОННАЯ СИСТЕМА
        - Windows 7 / 8 / 10 / 11
        - Linux (Ubuntu, Debian, CentOS и др.)
        - macOS

   1.2. ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ
        - PHP версии 7.4 или выше
        - MySQL версии 5.7 или выше (или MariaDB 10.3+)
        - Apache или Nginx веб-сервер
        - Браузер (Chrome, Firefox, Edge, Safari)

   1.3. РЕКОМЕНДУЕМАЯ КОНФИГУРАЦИЯ
        - RAM: минимум 2 GB (рекомендуется 4 GB)
        - Свободное место на диске: минимум 500 MB
        - Процессор: любой современный процессор


2. УСТАНОВКА НА WINDOWS (XAMPP)
─────────────────────────────────

   2.1. СКАЧИВАНИЕ XAMPP
        - Перейдите на https://www.apachefriends.org/download.html
        - Скачайте версию для Windows
        - Запустите установщик
        - Выберите компоненты: Apache, MySQL, PHP, phpMyAdmin
        - Установите в директорию по умолчанию: C:\xampp

   2.2. БЫСТРАЯ УСТАНОВКА (с помощью install.bat)
        - Скопируйте папку проекта в C:\xampp\htdocs\battery_tracker
        - Запустите файл install.bat (двойной клик)
        - Автоматически откроется:
          * XAMPP Control Panel
          * Браузер с phpMyAdmin
        - Дождитесь запуска Apache и MySQL (зеленые индикаторы)

   2.3. НАСТРОЙКА БАЗЫ ДАННЫХ
        В phpMyAdmin (автоматически откроется):
        - Нажмите "Импорт" в верхнем меню
        - Нажмите "Выберите файл"
        - Найдите и выберите файл database.sql из папки проекта
        - Нажмите кнопку "Вперёд" внизу страницы
        - Дождитесь сообщения об успешном импорте

   2.4. СОЗДАНИЕ ПОЛЬЗОВАТЕЛЯ ПО УМОЛЧАНИЮ
        Вариант А - через скрипт:
        - Откройте в браузере: http://localhost/battery_tracker/setup_user.php
        - Пользователь будет создан автоматически

        Вариант Б - через регистрацию:
        - Откройте: http://localhost/battery_tracker/register.php
        - Заполните форму регистрации

   2.5. ЗАПУСК ПРИЛОЖЕНИЯ
        - Откройте браузер
        - Перейдите по адресу: http://localhost/battery_tracker/
        - Войдите с учетными данными (см. раздел 8)

   2.6. ПОВТОРНЫЙ ЗАПУСК
        Для последующих запусков:
        - Запустите файл start.bat (двойной клик)
        ИЛИ
        - Откройте XAMPP Control Panel
        - Нажмите "Start" для Apache и MySQL


3. РУЧНАЯ УСТАНОВКА
────────────────────

   3.1. УСТАНОВКА XAMPP
        - Скачайте и установите XAMPP (см. 2.1)
        - Запустите XAMPP Control Panel
        - Запустите Apache и MySQL

   3.2. КОПИРОВАНИЕ ФАЙЛОВ
        - Скопируйте папку проекта в:
          Windows: C:\xampp\htdocs\battery_tracker
          Linux: /opt/lampp/htdocs/battery_tracker
          macOS: /Applications/XAMPP/htdocs/battery_tracker

   3.3. НАСТРОЙКА БАЗЫ ДАННЫХ
        Вариант А - через phpMyAdmin:
        - Откройте http://localhost/phpmyadmin/
        - Создайте новую базу данных: battery_tracker_db
        - Выберите кодировку: utf8mb4_unicode_ci
        - Импортируйте файл database.sql

        Вариант Б - через командную строку:
        mysql -u root -p < database.sql

   3.4. НАСТРОЙКА КОНФИГУРАЦИИ (при необходимости)
        Откройте файл: config/database.php
        
        Измените параметры подключения:
        DB_HOST - адрес сервера БД (обычно 'localhost')
        DB_NAME - имя базы данных ('battery_tracker_db')
        DB_USER - пользователь БД (по умолчанию 'root')
        DB_PASS - пароль БД (по умолчанию пустой '')

   3.5. ПРОВЕРКА ПРАВ ДОСТУПА (только для Linux/macOS)
        chmod -R 755 /opt/lampp/htdocs/battery_tracker
        chown -R nobody:nogroup /opt/lampp/htdocs/battery_tracker


4. УСТАНОВКА НА LINUX
──────────────────────

   4.1. УСТАНОВКА LAMP STACK (Ubuntu/Debian)
        sudo apt update
        sudo apt install apache2 mysql-server php php-mysql php-cli php-json
        sudo systemctl start apache2
        sudo systemctl start mysql

   4.2. КОПИРОВАНИЕ ФАЙЛОВ
        sudo cp -r battery_tracker /var/www/html/

   4.3. НАСТРОЙКА ПРАВ
        sudo chown -R www-data:www-data /var/www/html/battery_tracker
        sudo chmod -R 755 /var/www/html/battery_tracker

   4.4. НАСТРОЙКА БАЗЫ ДАННЫХ
        sudo mysql -u root
        CREATE DATABASE battery_tracker_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
        GRANT ALL PRIVILEGES ON battery_tracker_db.* TO 'root'@'localhost';
        FLUSH PRIVILEGES;
        EXIT;
        
        mysql -u root -p battery_tracker_db < database.sql

   4.5. ДОСТУП К ПРИЛОЖЕНИЮ
        http://localhost/battery_tracker/


5. УСТАНОВКА НА УДАЛЕННЫЙ СЕРВЕР
──────────────────────────────────

   5.1. ПОДГОТОВКА СЕРВЕРА
        - Установите Apache/Nginx, PHP 7.4+, MySQL 5.7+
        - Убедитесь, что включены модули PHP: pdo, pdo_mysql, session

   5.2. ЗАГРУЗКА ФАЙЛОВ
        - Загрузите все файлы проекта на сервер через FTP/SFTP
        - Разместите в корневой директории веб-сервера

   5.3. НАСТРОЙКА БАЗЫ ДАННЫХ
        - Создайте базу данных через панель управления хостингом
        - Импортируйте файл database.sql
        - Обновите config/database.php с данными вашего сервера

   5.4. НАСТРОЙКА .htaccess (для Apache)
        Создайте файл .htaccess в корне проекта:
        
        RewriteEngine On
        RewriteBase /
        
        # Защита конфигурационных файлов
        <Files "config/*.php">
            Order Allow,Deny
            Deny from all
        </Files>

   5.5. НАСТРОЙКА БЕЗОПАСНОСТИ
        - Измените пароль пользователя БД
        - Ограничьте доступ к config/database.php
        - Настройте SSL-сертификат (HTTPS)


6. ПРОВЕРКА УСТАНОВКИ
──────────────────────

   6.1. ТЕСТ ПОДКЛЮЧЕНИЯ К БД
        - Откройте главную страницу проекта
        - Если подключение неуспешно, появится сообщение об ошибке
        - Проверьте настройки в config/database.php

   6.2. ТЕСТ ФУНКЦИОНАЛА
        - Зарегистрируйте нового пользователя
        - Добавьте тестовое устройство
        - Добавьте запись о зарядке
        - Проверьте раздел аналитики

   6.3. ПРОВЕРКА ЛОГОВ
        Windows: C:\xampp\apache\logs\error.log
        Linux: /var/log/apache2/error.log


7. ОБНОВЛЕНИЕ СИСТЕМЫ
──────────────────────

   7.1. РЕЗЕРВНОЕ КОПИРОВАНИЕ
        - Сделайте backup базы данных через phpMyAdmin:
          Экспорт → Выбрать все таблицы → Вперёд
        - Скопируйте папку проекта

   7.2. ОБНОВЛЕНИЕ ФАЙЛОВ
        - Замените файлы проекта новой версией
        - Сохраните config/database.php с вашими настройками

   7.3. ОБНОВЛЕНИЕ БД (если требуется)
        - Выполните миграционные SQL-скрипты
        - Проверьте совместимость


8. НАСТРОЙКА ПОЛЬЗОВАТЕЛЯ ПО УМОЛЧАНИЮ
────────────────────────────────────────

   После установки выполните один из вариантов:

   ВАРИАНТ A - Автоматическое создание:
   - Откройте: http://localhost/battery_tracker/setup_user.php
   - Будет создан пользователь user123 с паролем pas123

   ВАРИАНТ B - Регистрация вручную:
   - Откройте: http://localhost/battery_tracker/register.php
   - Заполните форму регистрации


9. УСТРАНЕНИЕ ПРОБЛЕМ
──────────────────────

   9.1. APACHE НЕ ЗАПУСКАЕТСЯ
        Проблема: Порт 80 занят другим приложением
        Решение:
        - Закройте Skype, IIS или другие программы на порту 80
        - Измените порт Apache в httpd.conf (порт 8080)

   9.2. MYSQL НЕ ЗАПУСКАЕТСЯ
        Проблема: Порт 3306 занят
        Решение:
        - Остановите другие MySQL сервисы
        - Измените порт в my.ini

   9.3. ОШИБКА ПОДКЛЮЧЕНИЯ К БД
        Проверьте:
        - MySQL запущен
        - Правильные учетные данные в config/database.php
        - База данных создана и импортирована
        - Пользователь имеет права доступа

   9.4. БЕЛЫЙ ЭКРАН / ОШИБКА 500
        Включите отображение ошибок:
        - Откройте php.ini
        - Установите: display_errors = On
        - Перезапустите Apache

   9.5. ОШИБКИ ПРАВ ДОСТУПА (Linux)
        sudo chmod -R 755 /var/www/html/battery_tracker
        sudo chown -R www-data:www-data /var/www/html/battery_tracker


10. ДОПОЛНИТЕЛЬНЫЕ НАСТРОЙКИ
─────────────────────────────

   10.1. ИЗМЕНЕНИЕ ЧАСОВОГО ПОЯСА
         Откройте php.ini и установите:
         date.timezone = "Europe/Moscow"

   10.2. УВЕЛИЧЕНИЕ ЛИМИТОВ PHP
         upload_max_filesize = 50M
         post_max_size = 50M
         max_execution_time = 300

   10.3. НАСТРОЙКА СЕССИЙ
         session.gc_maxlifetime = 7200
         session.cookie_lifetime = 0


11. РЕЗЕРВНОЕ КОПИРОВАНИЕ
──────────────────────────

   11.1. BACKUP БАЗЫ ДАННЫХ
         Через phpMyAdmin:
         - Экспорт → SQL → Вперёд
         
         Через командную строку:
         mysqldump -u root -p battery_tracker_db > backup.sql

   11.2. BACKUP ФАЙЛОВ
         Скопируйте всю папку проекта в безопасное место


12. КОНТАКТЫ И ПОДДЕРЖКА
─────────────────────────

   При возникновении проблем:
   - Проверьте логи ошибок Apache и PHP
   - Убедитесь, что все требования выполнены
   - Проверьте права доступа к файлам и папкам


════════════════════════════════════════════════════════════════════════════════
                              Версия документа: 1.0
                              Дата: Декабрь 2025
════════════════════════════════════════════════════════════════════════════════
